Step 10: View node inventory
=================================

When ``discovery_provision.yml`` or ``utils/inventory_tagging.yml`` playbook is executed, a set of inventory files are created in the ``/opt/omnia/omnia_inventory/`` directory on the ``omnia_core`` container, based on the `Omnia database <Provision/ViewingDB.html>`_. The inventory files are:

      * ``compute_cpu_amd`` ::

            # This file is generated by omnia, and should not be edited
            [compute_cpu_amd]
            node001.omnia.test

      * ``compute_cpu_intel`` ::

            # This file is generated by omnia, and should not be edited
            [compute_cpu_intel]
            node001.omnia.test

      * ``compute_gpu_amd`` ::

           # This file is generated by omnia, and should not be edited
           [compute_gpu_amd]
           node002.omnia.test
           node003.omnia.test

      * ``compute_gpu_nvidia`` ::

            # This file is generated by omnia, and should not be edited
            [compute_gpu_nvidia]
            node001.omnia.test

      * ``compute_hostname_ip`` ::

            # This file is generated by omnia, and should not be edited
            [compute_hostname_ip]
            node001.omnia.test ansible_host=10.5.0.2
            node002.omnia.test ansible_host=10.5.0.3
            node003.omnia.test ansible_host=10.5.0.4

      * ``cluster_layout``: This will have inventory groups for all the roles except ``default``, ``oim_ha``, and service cluster roles. All Omnia provisioned nodes will be available in this inventory. ::

            # This file is generated by omnia, and should not be edited
            [login]
            node2.omnia.test
 
            [auth_server]
            node1.omnia.test
 
            [compiler_node]
            node3.omnia.test
      
      * ``<cluster_name>_cluster_layout``: This will be generated based on the ``cluster_name`` provided by the user in ``roles_config.yml``. This inventory is specifically generated for the service cluster roles. After ``discovery_provision.yml`` execution is complete, details about service cluster nodes will be added here. ::

            # This file is generated by omnia, and should not be edited
            [etcd]
            servicekubeetcd.omnia.test

            [kube_control_plane]
            servicekubecontrolplane.omnia.test

            [kube_node]
            servicekubenode1.omnia.test
            servicekubenode2.omnia.test

.. note::

    * Hostnames will only be written into the inventory files after the nodes are successfully PXE booted post provisioning.
    * For a node's hostname to list in an inventory file, two conditions must be met:

                * Node status must be "booted" in DB.
                * Node's hostname information is present in DB.
    * To regenerate all the inventory files, use the playbook ``utils/inventory_tagging.yml``.
    * After the nodes have successfully PXE booted, it may take up to three minutes for their details to appear in the generated inventory files.
    * Addition and deletion of service cluster nodes via inventory files is not supported.



